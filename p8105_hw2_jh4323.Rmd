---
title: "homework2"
author: "Jialiang Hua"
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
```

## Problem 1

Read the Mr. Trash Wheel dataset.

```{r}
trashwheel_df <- 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
    sheet = "Mr. Trash Wheel", 
    range = "A2:N534") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = round(sports_balls))
```

Read and clean precipitation data for 2018 and 2019

```{r}
precip18_df <-
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
    sheet = "2018 Precipitation",
    skip = 1) %>%
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2018) %>% 
  relocate(year)

precip19_df <-
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
    sheet = "2019 Precipitation",
    skip = 1) %>%
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2019) %>% 
  relocate(year)
```

Now combine precipitation datasets

```{r}
precip_df <-
  bind_rows(precip18_df, precip19_df) %>% 
  mutate(month = month.name[month])
```

The first data set was generated by Mr. Trashwheel trash collector in Baltimore, Maryland which include the information of trash entering, collection and dumpster storage. The dataset contains information on `r colnames(trashwheel_df)`. There are a total of `r nrow(trashwheel_df)` rows in the final dataset. 

The second data set was the month precipitation data in 2018 and 2019. The dataset contains information on `r colnames(precip_df)`. There are a total of `r nrow(precip_df)` rows in our final dataset.

* The total precipitation in 2018 was `r precip_df %>% filter(year == 2018) %>% pull(total) %>% sum()` inches.
* The median number of sports balls in a dumpster in 2019 was `r trashwheel_df %>% filter(year == 2019) %>% pull(sports_balls) %>% median()`


## Problem 2

First, clean the data in pols-month.csv

```{r polsmonthdf}
pols_month_df <-
  read_csv("./data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, sep = "-", into = c("year", "month", "day")) %>% 
  mutate(
    year = as.integer(year),
    month = as.integer(month), 
    day = as.integer(day),
    month = month.name[month],
    president = ifelse(prez_gop == 0, "dem", "gop")
  ) %>% 
  select(-day,  -prez_gop, -prez_dem) %>% 
  relocate(year, month, president)
view(pols_month_df)
```
    
Second, clean the data in snp.csv

```{r snpdf}
snp_df <- 
  read_csv("./data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  mutate(date = lubridate::mdy(date)) %>% 
  separate(date, into = c("year", "month", "day")) %>% 
  mutate(year = as.integer(year),
         month = as.integer(month),
         day = as.integer(day),
         month = month.name[month]) %>% 
  select(-day) %>% 
  arrange(year, month) %>% 
  relocate(year, month)
view(snp_df)
```

Third, tidy the unemployment data 

```{r}
unemployment_data <- 
  read_csv("./data/fivethirtyeight_datasets/unemployment.csv") %>% 
  pivot_longer(Jan:Dec, 
               names_to = "month", 
               values_to = "unemployment") %>% 
  janitor::clean_names() %>% 
  mutate(month = match(month, month.abb),
         month = month.name[month],
         year = as.integer(year))
```



